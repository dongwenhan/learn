## 1.消息中间件的主要概念

 一般来说，将AMQP 协议的内容分为三部分：基本概念、功能命令和传输层协议。基本概念是指AMQP 内部定义的各组件及组件的功能说明。功能命令是指该议所定义的一系列命令，应用程序可以基于这些命令来实现相应的功能。传输层协议是一个网络级协议，它定义了数据的传输格式，消息队列的客户端可以基于这个协议与消息代理和AMQP 的相关模型进行交互通信，该协议的内容包括数据帧处理、信道复用、内容编码心跳检测、数据表示和错误处理等。

### 1.1  主要概念
**Message （消息）**：消息服务器所处理数据的原子单元。消息可以携带内容，从格式上看，消息包括一个内容头、一组属性和一个内容体。这里所说的消息可以对应到许多不同应用程序的实体，比如一个应用程序级消息、一个传输文件、一个数据流帧等。消息可以被保存到磁盘上，这样即使发生严重的网络故障、服务器崩溃也可确保投递。消息可以有优先级，高优先级的消息会在等待同一个消息队列时在低优先级的消息之前发送，当消息必须被丢弃以确保消息服务器的服务质量时，服务器将会优先丢弃低优先级的消息。消息服务器不能修改所接收到的井将传递给消费者应用程序的消息内容体。消息服务器可以在内容头中添加额外信息，但不能删除或修改现有信息。
**Publisher （消息生产者）**：也是一个向交换器发布消息的客户端应用程序。
**Exchange （交换器）**：用来接收消息生产者所发送的消息井将这些消息路由给服务器中的队列。
**Binding （绑定） **： 用于消息队列和交换器之间的关联。一个绑定就是基于路由键将交换器和消息队列连接起来的路由规则，所以可以将交换器理解成一个由绑定构成的路由表。
**Virtual Host （虚拟主机）**：它是消息队列以及相关对象的集合，是共享同一个身份验证和加密环境的独立服务器域。每个虚拟主机本质上都是一个mini 版的消息服务器，拥有自己的队列、交换器、绑定和权限机制。
**Broker （消息代理）** ： 表示消息队列服务器实体，接受客户端连接，实现AMQP 消息队列和路由功能的过程。
**Routing Key （路由规则）**：虚拟机可用它来确定如何路由一个特定消息。
**Queue （消息队列）**：用来保存消息直到发送给消费者。它是消息的容器，也是消息的终点。一个消息可被投入一个或多个队列中。消息一直在队列里面，等待消费者连接到这个队列将其取走。
**Connection （连接）**： 可以理解成客户端和消息队列服务器之间的一个TCP 连接。
**Channel （信道）**：仅仅当创建了连接后，若客户端还是不能发送消息，则需要为连接创建一个信道。信道是一条独立的双向数据流通道，它是建立在真实的TCP 连接内的虚拟连接， AMQP 命令都是通过信道发出去的，不管是发布消息、订阅队列还是接收消息，它们都通过信道完成。一个连接可以包含多个信道，之所以需要信道，是因为TCP 连接的建立和释放都是昂贵的，如果客户端的每一个线程都需要与消息服务器交互，如果每一个线程都建立了一个TCP 连接，暂且不考虑TCP 连接是否浪费，就算操作系统也无法承受每秒建立如此多的TCP 连接。
**Consumer （消息消费者）**： 表示一个从消息队列中取得消息的客户端应用程序。